#!/usr/bin/env bash

set -o nounset -o pipefail -o errexit

clean() {
  sudo rm -rf "${HOME}/.docker"

  if command -v docker >/dev/null 2>&1; then
    docker system prune -a --volumes -f

    docker images --quiet | xargs docker rmi --force
    docker images --format '{{ .Repository }}:{{ .Tag}}' | xargs docker rmi --force
    docker network ls --quiet | xargs docker network rm
    docker volume ls --quiet | xargs docker volume rm
  fi
}

install() {
  if command -v brew >/dev/null 2>&1; then
    brew cask install docker
  fi

  if ! command -v docker >/dev/null 2>&1; then
    return
  fi

  local CTOP_VERSION="0.7.3"
  local OS
  OS="$(uname -s | tr "[:upper:]" "[:lower:]")"
  local ARCH
  ARCH="$(uname -m | tr "[:upper:]" "[:lower:]")"

  if [[ ${ARCH} == "x86_64" ]]; then
    ARCH="amd64"
  fi

  curl_to_binary "https://github.com/bcicen/ctop/releases/download/v${CTOP_VERSION}/ctop-${CTOP_VERSION}-${OS}-${ARCH}" "ctop"
}
